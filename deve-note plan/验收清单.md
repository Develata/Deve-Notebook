## 说明
- 本清单已细化为可直接转化为测试用例的条目。
- 具体测试用例见 `deve-note plan/acceptance-cases/00_index.md`。

## 术语与规范性
- TERM-001: 术语文档包含 MUST/SHOULD/MAY 定义。
- TERM-002: 核心术语定义齐全。
- TERM-003: 真值源约束表述明确。

## 项目定位与核心边界
- POS-001: `deve init` 初始化 Vault 与 Ledger。
- POS-002: `deve watch` 正确处理外部编辑器保存。
- POS-003: 双向闭环无死循环。
- POS-004: 重命名不丢 DocId。
- POS-005: `.deveignore` 生效。
- POS-006: 核心禁止项不默认启用。

## Markdown 渲染
- RENDER-BLOCK-001: 块级解析优先级。
- RENDER-INLINE-001: 行内解析优先级与转义。
- RENDER-CURSOR-001: 光标揭示规则。
- RENDER-LINK-001: Ctrl/Cmd 激活链接。
- RENDER-LINK-002: 外链安全属性强制。
- RENDER-LARGE-001: 大文档首屏与虚拟渲染。
- RENDER-MATH-001: 公式渲染与折叠。
- RENDER-MERMAID-001: Mermaid 静态渲染与尺寸。
- RENDER-RICH-001: 任务列表回写源码。
- RENDER-RICH-002: Frontmatter 样式与揭示。
- RENDER-CODE-001: 代码块工具栏与空状态。
- RENDER-WHITELIST-001: 语法白名单与限制。
- RENDER-NEST-001: 深度嵌套渲染稳定。
- RENDER-OUTLINE-001: Outline 解析规则。

## Diff 逻辑
- DIFF-001: UTF-16 索引一致。
- DIFF-002: 3-Way Merge 使用 LCA。
- DIFF-003: 冲突检测按 Hunk 触发。
- DIFF-004: 冲突 UI 三种策略。
- DIFF-005: 合并中断可续。
- DIFF-006: Watcher 防抖与 Hash 校验。
- DIFF-007: Diff 颜色语义。
- DIFF-008: 长文档打开策略。

## UI 界面
- UI-GEN-001: Design Tokens 使用 CSS 变量。
- UI-GEN-002: Z-Index 分层。
- UI-GEN-003: Focus Trap/Restore。
- UI-WEB-001: SPA 路由回退。
- UI-WEB-002: 断连锁屏。
- UI-WEB-003: Dashboard 刷新策略。
- UI-DESK-001: 5 列网格与 Diff 分屏。
- UI-DESK-002: Sidebar/Panel 拖拽与持久化。
- UI-DESK-003: Unified Search 模式切换。
- UI-MOB-001: 移动端视口映射。
- UI-MOB-002: Drawer 与 Edge Swipe。
- UI-MOB-003: 移动端无拉伸手柄。
- UI-MOB-004: Mobile Toolbar 与键盘适配。
- UI-MOB-005: Bottom Sheet 下拉关闭阈值/防抖/滚动冲突。
- UI-MOB-006: Drawer 标题栏与关闭按钮触控可达性一致。
- UI-MOB-007: Sidebar/Outline/Search Result 触控反馈语义一致。
- UI-MOB-008: 移动端 Diff 强制 Unified View。
- UI-MOB-009: Spectator "Read-Only Mode" 24px 橙色横幅。
- UI-MOB-010: `visualViewport` 驱动移动端辅助键盘栏底部偏移。
- UI-MOB-011: AI Chat 移动端采用可折叠 Chat Sheet，展开/收起不与 Drawer 冲突。
- UI-MOB-012: AI Chat 移动端输入区在软键盘弹起时不被遮挡，发送按钮可达且命中区 >= 44px。
- UI-MOB-013: AI Chat 移动端消息长文本换行与代码块横向滚动可读，展示消息时间与流式状态。
- UI-MOB-014: AI Chat 新增 UI 文案全部接入 i18n key（含 Apply/Retry/Loading 等）。
- UI-DIFF-001: Diff 打开后首屏优先渲染可视区（Chunk=300）并支持持续补全。
- UI-DIFF-002: 移动端 Unified Diff 支持编辑，输入采用 150ms 防抖。
- UI-DIFF-003: Diff 打开/关闭与 AI Chat、Drawer、Bottom Bar 不冲突。
- UI-DIFF-004: Diff 文案接入 i18n，无新增硬编码。
- UI-DIFF-005: 移动端 Diff 连续输入高频场景（10 次）下计算提示与最终渲染稳定。
- UI-DIFF-006: Diff 变更块导航（上一处/下一处）可滚动定位。
- UI-DIFF-007: Replace 行支持词级高亮标记。
- UI-DIFF-008: Diff 支持键盘快捷键导航变更块（`]`/`[`、`Alt+Down`/`Alt+Up`）。
- UI-DIFF-009: Diff 头部显示新增/删除统计并与内容一致。

## 网络连通
- NET-001: Web 端断连锁屏。
- NET-002: Main/Proxy 角色切换。
- NET-003: 协议格式区分。
- NET-004: OpenDoc Snapshot-First。
- NET-005: TOFU 握手与 Key Pair。
- NET-006: E2EE 与 Envelope Pattern。
- NET-007: Vector Gossip 缺失 Ops。
- NET-008: Snapshot Sync 覆盖模式。
- NET-009: 恶意数据隔离。
- NET-010: 间接同步信任边界。

## 多仓库与存储
- STORE-001: Trinity Isolation 结构。
- STORE-002: Repo 命名冲突自动重命名。
- STORE-003: Redb 索引表存在。
- STORE-004: Snapshot 双表与修剪。
- STORE-005: Ledger-First 与原子持久化。
- STORE-006: Clean File Policy。
- STORE-007: Watcher 事件映射。
- STORE-008: 数据恢复策略。
- STORE-009: UUID-First Retrieval。
- STORE-010: 路径规范化。

## 认证与安全
- AUTH-001: 12-Factor Auth 环境变量。
- AUTH-002: HTTPS/HTTP 策略。
- AUTH-003: CSRF 与 Rate Limiting。
- AUTH-004: JWT payload 最小化。
- AUTH-005: WS 握手鉴权。
- AUTH-006: Localhost 免密开关。

## I18n
- I18N-001: UI 文本不硬编码。
- I18N-002: Locale 检测优先级。
- I18N-003: 缺失 Key 回退。
- I18N-004: 后端仅返回错误码。
- I18N-005: 本地化格式。

## 插件
- PLUG-001: 双引擎可加载。
- PLUG-002: Capabilities 默认拒绝。
- PLUG-003: WASM 不直接操作 DOM。
- PLUG-004: Podman Rootless/No Net/Ephemeral。
- PLUG-005: AI 上下文安全。
- PLUG-006: KaTeX 扩展按配置加载。

## Commands 与 Settings
- CMD-001: CLI 命令可执行。
- CMD-002: Command Palette 快捷键。
- CMD-003: Quick Open 快捷键。
- CMD-004: Branch Switcher 快捷键。
- CMD-005: AI 模式切换。
- SET-001: 环境变量默认值。
- SET-002: `settings.toml` 配置生效。

## 技术栈与发布
- TECH-001: 技术栈版本匹配。
- TECH-002: Markdown 导出遵循 CommonMark + GFM。
- PERF-001: Low-Spec 配置生效。
- REL-001: Release Channels 命名规范。
- REL-002: Docker 部署可用。
- REL-003: 发布前检查项可验证。

## 移动端 UI 细节回归清单 (2026-02)
- REG-MOB-001: 左右抽屉可通过边缘滑动与按钮开启，且互斥。
- REG-MOB-002: 抽屉打开后 body 锁滚，关闭后恢复。
- REG-MOB-003: Drawer 标题栏与 Close 按钮命中区 >= 44px。
- REG-MOB-004: Bottom Sheet 在短促轻触/小位移下不误关闭。
- REG-MOB-005: Top Sheet 仅在顶部把手/头部区域上滑手势下关闭，不与结果列表滚动冲突。
- REG-MOB-006: Sidebar/Outline/Search Result 点击按压反馈一致（active/hover/selected）。
- REG-MOB-007: 移动端 Spectator 顶部显示 24px 橙色 Read-Only 横幅。
- REG-MOB-008: 移动端 Diff 仅单列 Unified，不出现左右并排。
- REG-MOB-009: `visualViewport` 变化时辅助键盘栏底部偏移随键盘同步。
- REG-MOB-010: `meta viewport` 含 `viewport-fit=cover` 与禁缩放参数。
- REG-MOB-011: Bottom Bar 折叠态单行显示 `Branch/Ready/Words/Lines/Col`，并可箭头展开/收起。
- REG-MOB-012: 展开态点击状态栏外任意区域自动收起。
- REG-MOB-013: 移动端关键按钮命中区 >= 44px（Top Bar / Drawer Close / Outline Toggle / Bottom Arrow）。
- REG-MOB-014: Bottom Bar 折叠态分支名自动截断，不挤压 `Ready/Words/Lines/Col`。
- REG-MOB-015: Top Sheet 上滑时有跟手位移反馈，未达阈值时平滑回弹。
- REG-MOB-016: AI Chat 折叠态为右下 `AI` 按钮，展开后为同页全屏聊天页面（非新窗口），关闭后恢复原编辑页面。
- REG-MOB-017: Drawer 打开时 AI Chat 不叠层显示；Drawer 关闭后 AI Chat 状态正确恢复。
- REG-MOB-018: AI Chat 发送失败后显示错误与重试入口，点击重试可重新发送上一条提问。
- REG-MOB-019: AI Chat 全屏页通过右上角关闭按钮返回，不依赖下拉手势关闭。
- REG-MOB-020: 移动端左抽屉顶部提供图标化侧栏入口，支持 Explorer/Search/Source Control/Extensions 切换。
- REG-MOB-021: 移动端 `More(...)` 支持固定项管理（Pin/Unpin），并与桌面端固定状态一致。
- REG-MOB-022: 移动端 `More(...)` 点击项后立即关闭；点击外部与 `Esc` 可关闭；抽屉关闭时菜单不残留。
- REG-MOB-023: 移动端 Diff 打开时不显示 AI Chat 入口与移动辅助键盘栏。
- REG-MOB-024: 移动端 Diff 头部关闭按钮命中区 >= 44px，点击后返回编辑页面。
