/* Loading Overlay (加载覆盖层) */
#loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #f8fafc;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: sans-serif;
  color: #64748b;
}
.hidden {
  display: none !important;
}

/* CodeMirror Overrides (CodeMirror 覆盖样式) */
.cm-editor {
  height: 100%;
}
.cm-scroller {
  overflow: auto;
}

/* Editor Content (编辑器内容区域) */
.cm-content {
  font-family: "Inter", sans-serif;
  font-size: 16px;
  line-height: 1.6;       /* [Layout] 全局行高 */
  padding: 2rem;          /* [Layout] 内容内边距 */
  max-width: 800px;       /* [Layout] 最大阅读宽度 */
  margin: 0 auto;         /* [Layout] 居中对齐 */
  padding-bottom: 5rem;   /* [Layout] 底部留白 (以便最后一行不贴底) */
  overflow-wrap: anywhere; /* [Fix] 强制长单词换行 */
}

/* Syntax Hiding (隐藏 Markdown 语法标记) */
.cm-syntax-hidden {
  display: none !important;
}

/* Math Widget (数学公式组件) */
.cm-math-widget {
  display: inline-block;
  background: #eee;
  padding: 0 4px;
  border-radius: 4px;
  cursor: pointer;
}
/* Block Math (行间公式) */
.cm-math-widget.cm-block-math {
  display: block;
  text-align: center;     /* [Layout] 居中显示 */
  margin: 1em 0;          /* [Layout] 上下间距 */
}

/* Frontmatter (元数据块) */
.cm-frontmatter-block {
  background-color: #f8f9fa; /* [Style] 浅灰背景 (匹配代码块) */
  font-family:
    "Menlo", "Monaco", "Consolas", "Liberation Mono", "Courier New", monospace;
  font-size: 0.85em;      /* [Style] 稍小的字号 */
  color: #64748b;
}

.cm-frontmatter-delim {
  color: #cbd5e1;
  font-weight: bold;
}

/* Checkbox Widget (复选框组件) */
.cm-checkbox-widget {
  margin-right: 0.5em;    /* [Layout] 右侧间距 */
  vertical-align: middle;
}

/* Table Widget (表格组件) */
.cm-table-widget {
  width: 100%;            /* [Layout] 宽度占满容器 */
  border-collapse: collapse;
  margin: 1em 0;          /* [Layout] 上下间距 */
  font-size: 14px;
}
.cm-table-widget th,
.cm-table-widget td {
  border: 1px solid #e2e8f0;
  padding: 8px 12px;      /* [Layout] 单元格内边距 */
}
.cm-table-widget th {
  background: #f1f5f9;
  font-weight: 600;
  color: #334155;
}
.cm-table-widget tbody tr:nth-child(even) {
  background: #f8fafc;    /* [Style] 隔行变色 */
}
.cm-table-widget tbody tr:hover {
  background: #e0f2fe;    /* [Style] 悬停高亮 */
}

/* Code Block Highlight (代码块高亮 - RStudio 风格) */
.cm-code-block-line {
  background-color: #f8f9fa; /* [Style] 浅灰背景 */
  border-radius: 0;
  /* [Note] 高度由内容和全局 line-height 决定，无额外 padding */
}

/* Optional: Rounded Corners for Start/End (代码块首尾圆角) */
.cm-code-block-start {
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
}
.cm-code-block-end {
  border-bottom-left-radius: 4px;
  border-bottom-right-radius: 4px;
}

/* Blockquote Styling (引用块样式 - RStudio 风格) */
.cm-blockquote-line {
  background-color: #f8f9fa; /* [Style] 匹配代码块背景 */
  border-left: 4px solid #cbd5e1; /* [Style] 左侧装饰线 */
}

/* Adjusting line padding for blockquotes (引用块内文本缩进) */
.cm-blockquote-line {
  padding-left: 1rem; /* [Layout] 内容缩进 (避免紧贴左侧线) */
}

/* Previous .cm-quote styles cleanup (清理旧的引用样式) */
.cm-quote {
  color: #64748b;
}


/* Inline Code Styling (行内代码样式) */
.cm-inline-code {
  background-color: #f1f5f9; /* slate-100 */
  color: #1e293b;            /* slate-800 */
  padding: 0.2em 0.4em;      /* [Layout] 内边距 */
  border-radius: 4px;
  font-family:
    "Menlo", "Monaco", "Consolas", "Liberation Mono", "Courier New", monospace;
  font-size: 1em; /* 稍大一点以便阅读 */
}

/* Explicit Markdown Styling (Markdown 基础样式) */
.cm-strong {
  font-weight: bold;
}
.cm-em {
  font-style: italic;
}
.cm-strikethrough {
  text-decoration: line-through;
}

/* Headings (标题样式) */
.cm-h1 {
  font-size: 2em;
  font-weight: bold;
  line-height: 1.2;
}
.cm-h2 {
  font-size: 1.5em;
  font-weight: bold;
  line-height: 1.3;
}
.cm-h3 {
  font-size: 1.25em;
  font-weight: bold;
  line-height: 1.4;
}
.cm-h4 {
  font-size: 1.1em;
  font-weight: bold;
}
.cm-h5 {
  font-size: 1em;
  font-weight: bold;
}
.cm-h6 {
  font-size: 0.9em;
  font-weight: bold;
  color: #64748b;
}

/* Links (链接样式) */
.cm-link {
  color: #2563eb;
  text-decoration: none;
}
.cm-link:hover {
  text-decoration: underline;
}
.cm-url {
  color: #94a3b8;
  font-family: monospace;
}

/* Blockquote Text (引用文本颜色) */
.cm-blockquote {
  color: #475569;
  font-style: italic;
}

/* Horizontal Rule (Source Text) (水平分割线源码) */
.cm-hr {
  color: #cbd5e1;
  font-weight: bold;
}

/* Rendered Horizontal Rule (渲染后的水平分割线) */
.cm-hr-rendered {
  color: transparent !important;   /* [Hack] 隐藏原文本颜色 */
  background-color: #cbd5e1;       /* [Style] 线条颜色 */

  display: inline-block;           /* [Layout] 布局模式 */
  width: 100%;                     /* [Layout] 全宽 */
  height: 2px;                     /* [Layout] 线条高度 */

  margin: 1em 0;                   /* [Layout] 上下间距 */
  line-height: 0px;                /* [Hack] 压扁行高 */
  overflow: hidden;                /* [Hack] 隐藏溢出内容 */
  vertical-align: middle;

  text-indent: -9999px;            /* [Hack] 将文本推移出可视区域 */
}

/* 
   Selection Styling (Native Browser Selection)
   使用浏览器原生选择机制，通过 ::selection 伪元素进行样式化
   这种方法比 CodeMirror 的 drawSelection() 更可靠，不会在滚动时消失
*/

/* 编辑器内的文本选择样式 */
.cm-editor ::selection {
  background-color: rgba(59, 130, 246, 0.4) !important;
  color: inherit;
}

.cm-editor ::-moz-selection {
  background-color: rgba(59, 130, 246, 0.4) !important;
  color: inherit;
}

/* 确保特殊块内的选择也可见 (代码块、引用、Frontmatter) */
.cm-code-block-line ::selection,
.cm-blockquote-line ::selection,
.cm-frontmatter-block ::selection {
  background-color: rgba(59, 130, 246, 0.5) !important;
}

.cm-code-block-line ::-moz-selection,
.cm-blockquote-line ::-moz-selection,
.cm-frontmatter-block ::-moz-selection {
  background-color: rgba(59, 130, 246, 0.5) !important;
}

/* 确保光标颜色正常 */
.cm-content {
  caret-color: #333;
}
